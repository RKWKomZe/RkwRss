{namespace rkwRss=RKW\RkwRss\ViewHelpers}

<f:if condition="{pages}">
	<f:for each="{pages}" as="page" iteration="iterator">
		<!--
			====================================================================
			Item {iterator.cycle}
			====================================================================
		-->
		<item>

			<!--
				++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
				Get header stuff
				++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
			-->
			<f:render partial="Rss/Common/ItemHeader" arguments="{_all}" />

			<!--
				++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
				The full content of the article
				++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
			-->
			<content:encoded>
				<f:format.cdata>
					<!doctype html>

					<!-- Set language -->
					<html lang="{feedLanguage}" prefix="op: http://media.facebook.com/op#">
						<head>

							<!-- Set canonical and markup version -->
							<meta charset="utf-8">
							<link rel="canonical" href="<f:uri.page absolute='TRUE' pageUid='{page.uid}' />">
							<meta property="op:markup_version" content="v1.0">
						</head>
						<body>
							<article>

								<!-- Header -->
								<header>
									<h1>{page.title}</h1>
									<f:if condition="{page.subtitle}">
										<h2>{page.subtitle}</h2>
									</f:if>

									<f:if condition="{page.teaserImage}" >
										<f:then>
											<figure>
												<f:image src="{page.teaserImage.uid}" absolute="1" treatIdAsReference="1" />
												<figcaption>{page.title}</figcaption>
											</figure>
										</f:then>
									</f:if>
									<time class="op-published" dateTime="<rkwRss:DateFormatInstantArticles dateTime='{page.crdate}' />"><f:format.date date="{page.crdate}" format="d.m.y H:i" /></time>
									<time class="op-modified" dateTime="<rkwRss:DateFormatInstantArticles dateTime='{page.tstamp}' />"><f:format.date date="{page.tstamp}" format="d.m.y H:i" /></time>
								</header>

								<!-- Content -->
								{page.content}

								<!-- Footer -->
								<footer>
									<small>
										<f:format.html parseFuncTSPath="lib.parseFunc">
											Â© <f:format.date date="{currentDate}" format="Y" /> {settings.copyrightHint}
										</f:format.html>
									</small>
								</footer>

								<!-- Tracker -->
								<figure class="op-tracker">
									<iframe>
										<f:render partial="Rss/TrackingCode" arguments="{_all}" />
									</iframe>
								</figure>
							</article>
						</body>
					</html>
				</f:format.cdata>

			</content:encoded>

		</item>
	</f:for>
</f:if>

